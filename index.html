<!DOCTYPE html>
<html>
<head>
    <title>Splat Test</title>
    <style>
        body { margin: 0; background: #222; color: white; display: flex; align-items: center; justify-content: center; height: 100vh; font-family: sans-serif; }
        #msg { text-align: center; }
    </style>
</head>
<body>
    <div id="msg">Инициализация...</div>
    <script type="module">
        import * as SPLAT from 'https://cdn.jsdelivr.net';

        async function start() {
            const msg = document.getElementById('msg');
            try {
                const canvas = document.createElement("canvas");
                const renderer = new SPLAT.WebGLRenderer(canvas);
                const scene = new SPLAT.Scene();
                const camera = new SPLAT.Camera();
                const controls = new SPLAT.OrbitControls(camera, canvas);
                
                document.body.innerHTML = ""; // Очищаем экран
                document.body.appendChild(canvas);

                await SPLAT.Loader.loadAsync("model.spz", scene, (p) => {
                    msg.innerText = `Загрузка: ${Math.round(p * 100)}%`;
                });

                const frame = () => {
                    controls.update();
                    renderer.render(scene, camera);
                    requestAnimationFrame(frame);
                };
                requestAnimationFrame(frame);
            } catch (e) {
                document.body.innerHTML = `<div style="color:red">Ошибка: ${e.message}<br>Проверьте, запущен ли сервер и верен ли путь к файлу.</div>`;
            }
        }
        start();
    </script>
</body>
</html>
